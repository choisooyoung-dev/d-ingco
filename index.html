<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap css cdn -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./style.css" />
    <title>D-ingco</title>
  </head>
  <body>
    <h1>Main page</h1>
    <nav>
      <div class="navbar_wrap">
        <div class="logo"></div>
        <ul class="menu">
          <li class="login_btn show">
            <a href="/views/users/login.html">로그인</a>
          </li>
          <li class="login_btn show">
            <a href="/views/users/signup.html">회원가입</a>
          </li>
          <li class="my_posts"><a href="/products/:usersid">내 글</a></li>
          <li class="logout_btn"><a href="/users/logout">로그아웃</a></li>
        </ul>
      </div>
    </nav>

    <section>
      <div id="post_list" class="row row-cols-1 row-cols-md-4 g-4">
        <!-- 
        <div class="col">
          <div class="card">
            <img src="..." class="card-img-top" alt="..." />
            <div class="card-body">
              <h5 class="card-title">Card title</h5>
              <p class="card-text">
                This is a longer card with supporting text below as a natural
                lead-in to additional content. This content is a little bit
                longer.
              </p>
            </div>
          </div>
        </div> 
        -->
      </div>
    </section>

    <!-- Bootstrap js cdn -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>

    <!-- 게시글 조회 axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      // 브라우저가 열렸을 때 실행
      document.addEventListener('DOMContentLoaded', function () {
        const $post_list = document.getElementById('post_list');
        // const user_id = document.getElementById('user_id').value

        axios
          .get('http://localhost:3000/api/posts')
          .then((response) => {
            // API 실행결과를 response로 받아와서 html 그려주기
            response.data.forEach((e) => {
              let temp_html = `
                <div class="col">
                  <div class="card">
                    <img src="..." class="card-img-top" alt="..." />
                    <div class="card-body">
                      <h5 class="card-title">${e.title}</h5>
                      <p class="card-text">
                        ${e.content}
                      </p>
                    </div>
                    <div>작성자 이름 : ${e.user.user_name}</div>                  
                    </div>
                </div> 
              `;
              $post_list.insertAdjacentHTML('beforeend', temp_html);
            });
          })
          .catch((error) => {
            console.error('오류 발생:', error);
          });
      });
    </script>
  </body>
</html>
